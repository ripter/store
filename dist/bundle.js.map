{"version":3,"file":"bundle.js","sources":["../src/getValueAtPath.js","../src/index.js"],"sourcesContent":["// from: https://github.com/you-dont-need/You-Dont-Need-Lodash-Underscore#_get\nexport const getValueAtPath = (obj, path, defaultValue = null) =>\n  String.prototype.split.call(path, /[,[\\].]+?/)\n    .filter(Boolean)\n    .reduce((a, c) => (Object.hasOwnProperty.call(a,c) ? a[c] : defaultValue), obj);\n","import { getValueAtPath } from './getValueAtPath.js';\n\n/**\n * A Store holds an object as it's internal state.\n * The state can be read with `.getState(keyPath, defaultValue)`\n * State can be set by reducers in the `.reducers` array.\n * Trigger the reducers to run with `.action(obj)`.\n * Once the reducers run, `.onChange` is called with the new state.\n * @type {Store}\n */\nclass Store {\n  constructor(initalState, reducers, onChange) {\n    this._state = initalState;\n    this._pendingActions = [];\n\n    this.onChange = onChange;\n    // Reducers: (state, action, nextAction) => state\n    this.reducers = reducers;\n  }\n\n  /**\n   * Performs an action on the store.\n   * Triggers the onChange callbacks with the new state.\n   * @param  {Object} actionObj is added to each reducer along with the current state.\n   * @return {Object} returns the new state.\n   */\n  action(actionObj) {\n    const { onChange, _pendingActions, _state } = this;\n    let state;\n\n    // perform the action on our state.\n    state = this.runReducers(_state, actionObj);\n    // Run the reduers until all pending actions have been handled.\n    while(_pendingActions.length > 0) {\n      const nextActionObj = _pendingActions.pop();\n      state = this.runReducers(state, nextActionObj);\n    }\n\n    // Trigger that we changed.\n    if (onChange) { onChange(state); }\n    this._state = state;\n    return state;\n  }\n\n  /**\n   * Runs all the reducers and returns the new state.\n   * *SideEffect:* allows reducers to add to this._pendingActions\n   * @private\n   * @param  {Object} state\n   * @param  {Object} actionObj\n   * @return {Object} new state\n   */\n  runReducers(state, actionObj) {\n    const { reducers, _pendingActions } = this;\n    const pushNextAction = (nextActionObj) => {\n      _pendingActions.push(nextActionObj);\n    };\n\n    return reducers.reduce((acc, reducer) => {\n      // call each reducer function.\n      // (state, actionObj, nextAction) -> newState\n      const newState = reducer(acc, actionObj, pushNextAction);\n      // reducers *MUST* return the updated state. Check for errors.\n      if (newState == null) { throw new Error(`Store: Reducers must return a state object.\\nStore: Got '${newState}' instead.`); }\n      return newState;\n    }, state);\n  }\n\n  /**\n   * Returns the value at path.\n   * If the value doesn't exist, it will return defaultValue or undefined.\n   * @refrence: https://lodash.com/docs/4.17.4#get\n   * @param {String} path - path of the property to get.\n   * @param {Object} defaultValue - value to return if there is no value at path.\n   * @return {Object}\n   */\n  get(path, defaultValue) {\n    const { _state } = this;\n    if (!path) { return _state; }\n    return getValueAtPath(_state, path, defaultValue);\n  }\n}\nexport default Store;\n"],"names":[],"mappings":"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"}